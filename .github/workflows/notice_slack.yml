# This workflow will run tests using node and then publish a package to GitHub Packages when a release is created
# For more information see: https://help.github.com/actions/language-and-framework-guides/publishing-nodejs-packages

name: Notice Slack

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  build:

    runs-on: ubuntu-latest
    
    steps:
      - name: slack-send
      # You may pin to the exact commit or the version.
      # uses: slackapi/slack-github-action@d5d276d7ae0f38f29322b80da9baf985cc80f8b1
        uses: slackapi/slack-github-action@v1.15.0
        with:
          # JSON payload to send to Slack if webhook route. If not supplied, json from GitHub event will be sent instead
          slack-message: "{\"attachments\":[{\"blocks\":[{\"type\":\"header\",\"text\":{\"type\":\"plain_text\",\"text\":\"App 有新的更新\"}},{\"type\":\"section\",\"fields\":[{\"type\":\"mrkdwn\",\"text\":\"*VersionName*\\n2.1.3\"},{\"type\":\"mrkdwn\",\"text\":\"*VersionCode*\\n4001865\"}]},{\"type\":\"section\",\"fields\":[{\"type\":\"mrkdwn\",\"text\":\"*Platform*\\nandroid\"},{\"type\":\"mrkdwn\",\"text\":\"*Download*\\nhttp://www.baidu.com\"}]},{\"type\":\"section\",\"fields\":[{\"type\":\"mrkdwn\",\"text\":\"*Release Notes*\\nandroid\"}]},{\"type\":\"actions\",\"elements\":[{\"type\":\"button\",\"text\":{\"type\":\"plain_text\",\"text\":\"前往下载\"},\"value\":\"http://www.baidu.com\",\"action_id\":\"actionId-0\"}]}]}]}"
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK }}
